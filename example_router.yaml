endpoints:
  primary: https://s3.us‑west‑1.amazonaws.com
  secondary: https://r2.cloudflarestorage.com

# Each op has 5 options:
# - primary
# - secondary
# - fallback
# - best-effort
# - mirror

rules:
  # bucket 'photo' in primary (s3) map to bucket 'cf-photos' in secondary (r2)
  - bucket: photos@primary:cf-photos@secondary
    prefix:
      "raw/":
        PutObject: mirror # primary & secondary must succeed
        DeleteObject: best-effort # if primary fails, return secondary's response
        CompleteMultipartUpload: mirror
        GetObject: fallback
        "*": fallback # all other ops → fallback read path
      "processed/":
        "*": secondary # only send to secondary
      "*": # remaining prefixes
        "*": primary # only send to primary
